classDiagram
    direction TB

    %% ==================== ENUMS ====================
    class SeatClass {
        <<enumeration>>
        ECONOMY
        BUSINESS
    }

    class FlightStatus {
        <<enumeration>>
        SCHEDULED
        BOARDING
        DEPARTED
        ARRIVED
        CANCELLED
        DELAYED
    }

    class ReservationStatus {
        <<enumeration>>
        PENDING
        CONFIRMED
        CANCELLED
        COMPLETED
    }

    class TicketStatus {
        <<enumeration>>
        ISSUED
        CHECKED_IN
        BOARDED
        USED
        REFUNDED
    }

    class UserRole {
        <<enumeration>>
        CUSTOMER
        STAFF
        ADMIN
    }

    %% ==================== FLIGHT MODULE ====================
    class Route {
        -String routeId
        -String departureCity
        -String departureAirport
        -String arrivalCity
        -String arrivalAirport
        -int distance
        +Route(depCity, depAirport, arrCity, arrAirport)
        +getRouteDescription() String
    }

    class Seat {
        -String seatNum
        -SeatClass Class
        -double price
        -boolean reserveStatus
        -int row
        -char column
        +Seat(seatNum, Class, price)
        +reserve() void
        +release() void
        +isReserveStatus() boolean
    }

    class Plane {
        -String planeId
        -String planeModel
        -int capacity
        -Map~String,Seat~ seatMatrix
        -int rows
        -int seatsPerRow
        +Plane(id, model, rows, seatsPerRow)
        +initializeSeats() void
        +getSeat(seatNum) Seat
        +getAvailableSeats() List~Seat~
    }

    class Flight {
        -String flightNum
        -String departurePlace
        -String arrivalPlace
        -LocalDate date
        -LocalTime hour
        -int duration
        -Plane plane
        -Route route
        -FlightStatus status
        +Flight(flightNum, route, date, hour, duration, plane)
        +getArrivalTime() LocalDateTime
        +getDepartureDateTime() LocalDateTime
        +isExpired() boolean
        +getAvailableSeats() List~Seat~
    }

    %% ==================== RESERVATION MODULE ====================
    class Passenger {
        -String passengerId
        -String name
        -String surname
        -String email
        -String phone
        -String passportNo
        +Passenger(id, name, surname, email, phone)
        +getFullName() String
        +getContactInfo() String
    }

    class Reservation {
        -String reservationCode
        -Flight flight
        -Passenger passenger
        -Seat seat
        -LocalDateTime dateOfReservation
        -ReservationStatus status
        +Reservation(flight, passenger, seat)
        +generateCode() String
        +cancel() void
        +confirm() void
    }

    class Baggage {
        -String baggageId
        -double weight
        -int allowance
        -double extraFee
        +Baggage(weight, allowance)
        +calculateExtraFee() double
        +isOverweight() boolean
    }

    class Ticket {
        -String ticketId
        -Reservation reservation
        -double price
        -Baggage baggage
        -int baggageAllowance
        -LocalDateTime issueDate
        -TicketStatus ticketStatus
        +Ticket(reservation, price)
        +generateTicketId() String
        +calculateTotalPrice() double
    }

    %% ==================== SERVICES & MANAGERS ====================
    class FlightManager {
        -List~Flight~ flights
        -List~Plane~ planes
        -List~Route~ routes
        +createFlight(flightNum, route, ...) Flight
        +updateFlight(flight) boolean
        +deleteFlight(flightNum) boolean
        +getFlightByNumber(num) Flight
        +getAllFlights() List~Flight~
        +saveToFile() void
        +loadFromFile() void
    }

    class SeatManager {
        -Plane plane
        +SeatManager(plane)
        +createSeatLayout() void
        +emptySeatsCount() int
        +reserveSeat(seatNum) boolean
        +releaseSeat(seatNum) boolean
        +getSeat(seatNum) Seat
        +getAvailableSeats() List~Seat~
        +getSeatsByClass(seatClass) List~Seat~
    }

    class ReservationManager {
        -List~Reservation~ reservations
        -ReentrantLock lock
        +makeReservation(flight, passenger, seat) Reservation
        +cancelReservation(code) boolean
        +getReservation(code) Reservation
        +getReservationsByPassenger(id) List~Reservation~
        +synchronizedReserve(seat) boolean
        +saveToFile() void
        +loadFromFile() void
    }

    class PriceCalculator {
        -double basePrice
        -double taxRate
        +calculatePrice(seat, flight) double
        +calculateBusinessPrice(base) double
        +calculateEconomyPrice(base) double
        +applyDiscount(price, percent) double
        +calculateTax(price) double
        +calculateTotalWithTax(price) double
    }

    class FlightSearchEngine {
        -FlightManager flightManager
        +searchFlights(from, to, date) List~Flight~
        +filterByDeparture(city) List~Flight~
        +filterByArrival(city) List~Flight~
        +filterByDate(date) List~Flight~
        +removeExpiredFlights() List~Flight~
        +getAvailableFlights() List~Flight~
    }

    class ReportGenerator {
        <<Runnable>>
        -FlightManager flightManager
        -ReservationManager reservationManager
        +run() void
        +generateOccupancyReport() String
        +generateRevenueReport() String
        +calculateOccupancyRate(flight) double
        +onReportComplete(callback) void
    }

    %% ==================== USER CLASSES ====================
    class User {
        <<abstract>>
        #String userId
        #String username
        #String password
        #String email
        #UserRole role
        +login(username, password) boolean
        +logout() void
        +getPermissions()* List~String~
    }

    class Customer {
        -Passenger passenger
        -List~Reservation~ reservationHistory
        +getPermissions() List~String~
        +viewReservations() List~Reservation~
        +makeReservation(flight, seat) Reservation
    }

    class Staff {
        -String staffId
        -String department
        -String position
        +getPermissions() List~String~
        +manageFlights() void
        +viewAllReservations() List~Reservation~
        +generateReports() void
    }

    class Admin {
        -int adminLevel
        +getPermissions() List~String~
        +manageStaff() void
        +manageUsers() void
        +systemSettings() void
    }

    class FileManager {
        -String basePath
        +saveObject(obj, filename)$ void
        +loadObject(filename)$ Object
        +saveList(list, filename)$ void
        +loadList(filename)$ List
        +fileExists(filename)$ boolean
    }

    %% ==================== RELATIONSHIPS ====================

    %% Composition (strong ownership - filled diamond)
    Plane *-- Seat : contains
    Ticket *-- Reservation : contains
    Ticket *-- Baggage : contains

    %% Aggregation (weak ownership - empty diamond)
    Flight o-- Plane : uses
    Flight o-- Route : has

    %% Association
    Reservation --> Flight : refers to
    Reservation --> Passenger : has
    Reservation --> Seat : has
    Customer --> Passenger : has

    %% Dependency (uses)
    FlightManager ..> Flight : manages
    FlightManager ..> Plane : manages
    FlightManager ..> Route : manages
    SeatManager ..> Seat : manages
    SeatManager ..> Plane : uses
    ReservationManager ..> Reservation : manages
    PriceCalculator ..> Seat : uses
    PriceCalculator ..> Flight : uses
    FlightSearchEngine ..> FlightManager : uses
    ReportGenerator ..> FlightManager : uses
    ReportGenerator ..> ReservationManager : uses

    %% Inheritance
    Customer --|> User : extends
    Staff --|> User : extends
    Admin --|> Staff : extends

    %% Enum usage
    Seat ..> SeatClass : uses
    Flight ..> FlightStatus : uses
    Reservation ..> ReservationStatus : uses
    Ticket ..> TicketStatus : uses
    User ..> UserRole : uses
